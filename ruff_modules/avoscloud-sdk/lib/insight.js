"use strict";var _=require("underscore");module.exports=function(i){i.Insight=i.Insight||{},_.extend(i.Insight,{startJob:function(t,r){if(!t||!t.sql)throw new Error("Please provide the sql to run the job.");var e={jobConfig:t,appId:i.applicationId},n=i._request("bigquery","jobs",null,"POST",i._encode(e,null,!0));return n.then(function(t){return i._decode(null,t).id})._thenRunCallbacks(r)},on:function(i,t){}}),i.Insight.JobQuery=function(i,t){if(!i)throw new Error("Please provide the job id.");this.id=i,this.className=t,this._skip=0,this._limit=100},i.Insight.JobQuery.prototype={skip:function(i){return this._skip=i,this},limit:function(i){return this._limit=i,this},find:function(t){var r={skip:this._skip,limit:this._limit},e=i._request("bigquery","jobs",this.id,"GET",r);return e.then(function(t){return t.error?i.Promise.error(new i.Error(t.code,t.error)):i.Promise.as(t)})._thenRunCallbacks(t)}}};